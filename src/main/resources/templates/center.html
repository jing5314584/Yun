<!DOCTYPE html>
<html class="no-js">
<head>
<meta charset="UTF-8">
<META HTTP-EQUIV="pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate">
<META HTTP-EQUIV="expires" CONTENT="0">
<title>花语-个人中心</title>
<meta name="description" content="">
<meta name="keywords" content="">
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no,viewport-fit=cover">
<meta name="renderer" content="webkit">
<meta name="format-detection" content="telephone=no">
<meta http-equiv="Cache-Control" content="no-siteapp" />
<meta name="x5-orientation" content="portrait">

<link rel="stylesheet" href="/css/amazeui.min.css">



<link rel="stylesheet" href="/css/app.min.2.0.css?v=10006">
<link rel="stylesheet" href="/css/redeem.css">
<link rel="stylesheet" href="/css/fightgroup.css" type="text/css"></link>
<style type="text/css">
.userFootBar,.footeNavbar {
	/*padding-bottom: constant(safe-area-inset-bottom) !important;*/
	padding-bottom: env(safe-area-inset-bottom) !important;
	height: auto !important;
	min-height: 45px;
}

.footeNavbar>div>div>div,.footeNavbar>div>div>div>a>div {
	height: 45px;
}
</style>

<script
	src="http://static.iishang.com/customer/javascript/jquery.min.js"></script>
<script src="http://static.iishang.com/customer/javascript/myjs.js"></script>


<script
	src="http://static.iishang.com/customer/javascript/amaze-2.7.1/js/amazeui.min.js"></script>
<script
	src="http://static.iishang.com/customer/javascript/other-1.0/jquery.event.drag-1.5.min.js"></script>
<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>












<script>
	var api_addr = "http://aishang-mall-rest.iishang.com/";
</script>


<script
	src="http://m.iishang.com:80/resources/assets/js/orderConfirm.js?v=10000"></script>
<link rel="stylesheet" href="/css/confirm.css">
<link rel="stylesheet" href="/css/cart.css">
<link rel="stylesheet" type="text/css" href="/css/common.css">
<script type="text/javascript"
	src="http://static.iishang.com/customer/javascript/vue/vue.min.js"></script>

<style>
.v2-more {
	margin-right: 0;
	background:
		url('http://static.iishang.com/customer/images/icons/back.png') 100%
		50% no-repeat;
	transform: rotate(180deg);
	background-size: auto 20px;
	background-position-x: 10%;
}

.bottom {
	background-color: #fff;
	border-top: 1px solid #f2f2f2;
	bottom: 0;
	height: 45px;
	position: fixed;
	width: 100%;
	text-align: center;
	max-width: 640px;
}

.space_split {
	border-right: solid 1px #F2F2F2;
}
</style>
</head>
<body>
	<div id="app" class="am-g common cart" v-cloak>
		<!-- <header>
            <div class="am-u-sm-2">
                <img src="http://static.iishang.com/customer/images/icons/back.png" @click="back();">
            </div>
            <div class="am-u-sm-8 am-pad-none am-text-center" style="float:left">
                个人中心
            </div>        
        </header>   -->
		<div class="am-u-sm-12 am-pad-none"
			style="height: 109px; padding-left: 12px;color: #999">
			<div class="am-u-sm-2 am-pad-none"
				style="margin-top: 25px; text-align: right;" @click="logout();">
				<img class="cart_img"
					style="width:60px;height:60px;border-radius:50%" :src="user_avatar">
			</div>
			<div class="am-u-sm-10 am-pad-none" style="margin-top: 25px">
				<div class="am-u-sm-12">

					<img v-if="user_grade == 'V0'" style="width: 22px;"
						src="http://static.iishang.com/customer/images/grad/V0.png" /> <img
						v-else-if="user_grade == 'V1'" style="width: 22px;"
						src="http://static.iishang.com/customer/images/grad/V1.png" /> <img
						v-else-if="user_grade == 'V2'" style="width: 22px;"
						src="http://static.iishang.com/customer/images/grad/V2.png" /> <img
						v-else-if="user_grade == 'V3'" style="width: 22px;"
						src="http://static.iishang.com/customer/images/grad/V3.png" /> <img
						v-else-if="user_grade == 'V4'" style="width: 22px;"
						src="http://static.iishang.com/customer/images/grad/V4.png" /> <img
						v-else-if="user_grade == 'V5'" style="width: 22px;"
						src="http://static.iishang.com/customer/images/grad/V5.png" /> <img
						v-else-if="user_grade == 'V6'" style="width: 22px;"
						src="http://static.iishang.com/customer/images/grad/V6.png" /> <img
						v-else-if="user_grade == 'V7'" style="width: 22px;"
						src="http://static.iishang.com/customer/images/grad/V7.png" /> <span
						style="font-size: 16px; color: #000;padding-left: 12px">{{userName}}</span>

				</div>
				<div class="am-u-sm-12">
					<span style="font-size: 16px; color: #9E9E9E;padding-left: 12px">ID:{{user_show_id}}</span>
				</div>
				<!--  <div class="am-u-sm-12" style="height: 12px; margin-top: 14px;">
                    <a href="/rank/toRank.do" style="color: #999;z-index: 100;position:relative">
                        <span style="border:solid 1px #F2F2F2; border-radius: 10px; display: inline-block; padding-left: 5px; padding-right: 5px; height:22px">经验值 {{experience}}</span>
                    </a>
                    <a href="/integral/toIntegral.do" style="color: #999;z-index: 100;position:relative">
                        <span style="border:solid 1px #F2F2F2; border-radius: 10px; display: inline-block; padding-left: 5px; padding-right: 5px; height:22px; margin-left: 10px">积分 {{integral}}</span>
                    </a>
                </div> -->
				<!-- <div class="am-u-sm-6" style="border:solid 1px; border-radius: 10px; margin-top: 5px">经验值 {{experience}}</div>
                <div class="am-u-sm-5" style="border:solid 1px; border-radius: 10px; margin-top: 5px">积分 {{integral}}</div> -->
			</div>
			<!-- <a href="/account/toAccount.do" class="am-u-sm-4 am-pad-none am-text-right" style="right:15px;height:10px;margin-top: -30px;">
                
                    <img src="http://static.iishang.com/customer/images/icons/back.png" style="width:10px;transform: rotate(180deg);">
            </a> -->
		</div>
		<!--  <div class="am-u-sm-12" style="border-top: solid 1px #F2F2F2; padding: 10px 0; text-align: center;">
            <a href="/coupon/toCoupon.do" style="color: #999">
                <div class="am-u-sm-3 am-pad-none space_split">
                    <div class="am-u-sm-12" style="color: #000">{{couponsCount}}</div>
                    <div class="am-u-sm-12 am-pad-none no_wrap">优惠券</div>
                </div>
            </a>

            <a href="/user/invitation.do" style="color: #999">
                <div class="am-u-sm-3 am-pad-none space_split">
                    <div class="am-u-sm-12" style="color: #000">{{countInvod}}</div>
                    <div class="am-u-sm-12 am-pad-none no_wrap">邀请码</div>
                </div>
            </a>  

            <a href="/redeems/list.do" style="color: #999">
                <div class="am-u-sm-3 am-pad-none space_split">
                    <div class="am-u-sm-12" style="color: #000">{{redeemCount}}</div>
                    <div class="am-u-sm-12 am-pad-none no_wrap">兑换码</div>
                </div> 
            </a>  
            <a href="http://m.iishang.com:80/user/order/upgrade.do" style="color: #999">
                <div class="am-u-sm-3 am-pad-none">
                    <div class="am-u-sm-12" style="color: #000">{{upgradeCount}}</div>
                    <div class="am-u-sm-12 am-pad-none no_wrap">套餐升级</div>
                </div> 
            </a>                    
        </div> -->
		<div class="greyBg">&nbsp;</div>
		<div class="am-u-sm-12 am-pad-none"
			style="padding-left:15px; padding-right:15px">
			<div class="am-u-sm-2 grzxListImg">
				<img src="/svg/order.svg" width="32"
					style="margin-top: 3px" />
			</div>
			<a href="orderlist.html?type=0">
				<div class="am-u-sm-8 grzxListText"
					style="color: #666666;border-bottom:none">全部订单</div>
				<div class="am-u-sm-2 am-pad-none am-text-right"
					style="color:#9e9e9e; margin-top: 20px;">

					<img src="/images/icons/back.png"
						style="width:10px;transform: rotate(180deg);">
				</div>
			</a>
			<div class="am-u-sm-12 split_user"></div>
		</div>

		<div class="am-u-sm-12" style="text-align: center;padding:10px">
			<div class="am-u-sm-3">
				<a href="http://m.iishang.com:80/user/order/list.do?type=2"
					style="color: #999">
					<div class="am-u-sm-12 grzxListImg">
						<img src="/svg/waitpay.svg" width="26" height="28" />
						<div class="icon">15</div>
					</div>
					<div class="am-u-sm-12"
						style="padding-left: 0px; padding-right: 0px">待付款</div>
				</a>
			</div>
			<div class="am-u-sm-3">
				<a href="http://m.iishang.com:80/user/order/list.do?type=3"
					style="color: #999">
					<div class="am-u-sm-12 grzxListImg">
						<img src="/svg/inService.svg" width="28" height="28" />
						<div v-if="serviceOrders != 0" class="icon">{{serviceOrders
							| formatCount}}</div>
					</div>
					<div class="am-u-sm-12"
						style="padding-left: 0px; padding-right: 0px">服务中</div>
				</a>
			</div>
			<div class="am-u-sm-3">
				<a href="http://m.iishang.com:80/user/order/list.do?type=4"
					style="color: #999">
					<div class="am-u-sm-12 grzxListImg">
						<img src="/svg/finish.svg" width="26" height="28" />
						<div class="icon">1</div>
					</div>
					<div class="am-u-sm-12"
						style="padding-left: 0px; padding-right: 0px">已完成</div>
				</a>
			</div>
			<div class="am-u-sm-3">
				<a href="http://m.iishang.com:80/user/order/list.do?type=5"
					style="color: #999">
					<div class="am-u-sm-12 grzxListImg">
						<img src="/svg/daipingjia.svg" width="26" height="28" />
						<div class="icon">12</div>
					</div>
					<div class="am-u-sm-12"
						style="padding-left: 0px; padding-right: 0px">待评价</div>
				</a>
			</div>
			
		</div>
		<div class="greyBg">&nbsp;</div>


		<div class="am-u-sm-12 am-pad-none"
			style="padding-left: 15px; padding-right: 15px">
			<div class="am-u-sm-2 grzxListImg">
				<img src="/svg/address.svg" width="28"
					style="margin-top: 3px" />
			</div>
			<a href="addresslist.html">
				<div class="am-u-sm-8 grzxListText"
					style="color: #666666;border-bottom:none">收货地址</div>
				<div class="am-u-sm-2 am-pad-none am-text-right"
					style="color:#9e9e9e; margin-top: 20px">

					<img src="/images/icons/back.png"
						style="width:10px;transform: rotate(180deg);">

				</div>
			</a>
			<div class="am-u-sm-12 split_user"></div>
		</div>
		<div class="am-u-sm-12 am-pad-none"
			style="padding-left: 15px; padding-right: 15px">
			<div class="am-u-sm-2 grzxListImg">
				<img src="/svg/aboutus.svg" width="26"
					style="margin-top: 3px" />
			</div>
			<a href="about_us.html">
				<div class="am-u-sm-8 grzxListText"
					style="color: #666666;border-bottom:none">关于我们</div>
				<div class="am-u-sm-2 am-pad-none am-text-right"
					style="color:#9e9e9e; margin-top: 20px">

					<img src="/images/icons/back.png"
						style="width:10px;transform: rotate(180deg);">
				</div>
			</a>
			<div class="am-u-sm-12 split_user"></div>
		</div>


		<!--  <div class="greyBg">&nbsp;</div> -->


		<!--  <div class="am-u-sm-12 am-pad-none" style="padding-left: 15px; padding-right: 15px">
            <div class="am-u-sm-2 grzxListImg">
                <img src="http://static.iishang.com/customer/images/icons/shequ.png" width="23" style="margin-top: 3px"/>
            </div>
            <a href="https://shequ.yunzhijia.com/thirdapp/forum/network/56977332e4b04104d5b7eb35">
                <div class="am-u-sm-8 grzxListText" style="color: #666666;border-bottom:none">
                        我的社区
                </div>
                <div class="am-u-sm-2 am-pad-none am-text-right" style="color:#9e9e9e; margin-top: 20px;">
                    <img src="http://static.iishang.com/customer/images/icons/back.png" style="width:10px;transform: rotate(180deg);">
                </div>                
            </a>
        </div>

        <div class="greyBg">&nbsp;</div>

        <div v-if="!isWx" class="am-u-sm-12 am-pad-none" @click="logout()" style="padding-left: 15px; padding-right: 15px">
            <div class="am-u-sm-2 grzxListImg">
                <img src="http://static.iishang.com/customer/images/icons/logout.png" width="23" style="margin-top: 3px"/>
            </div>
            <div class="am-u-sm-8 grzxListText" style="color: #666666;border-bottom:none">
                退出登录
            </div>
            <div class="am-u-sm-2 am-pad-none am-text-right" style="color:#9e9e9e; margin-top: 20px;">
                <img src="http://static.iishang.com/customer/images/icons/back.png" style="width:10px;transform: rotate(180deg);">
            </div>
            <div class="am-u-sm-12 split_user"></div>
        </div> -->






		<div class="am-u-sm-12 userFootBar"
			style="padding-top: 3px;z-index: 200">
			<div class="am-u-sm-6" @click="selectChange('home')">
				<div class="am-u-sm-12 img_div" v-if="!selectList.home">
					<img src="http://static.iishang.com/customer/images/icons/home.png"
						width="20" height="20" />
				</div>
				<div class="am-u-sm-12 img_div" v-show="selectList.home">
					<img
						src="http://static.iishang.com/customer/images/icons/home_select.png"
						width="20" height="20" />
				</div>
				<div class="am-u-sm-12" style="font-size: 12px; color:#666"
					v-if="!selectList.home">首页</div>
				<div class="am-u-sm-12" style="font-size: 12px; color: #fe5478"
					v-if="selectList.home">首页</div>
			</div>
			<div class="am-u-sm-6" @click="selectChange('user')">
				<div class="am-u-sm-12 img_div" v-if="!selectList.user">
					<img
						src="http://static.iishang.com/customer/images/icons/user.png?11"
						width="20" height="20" />
				</div>
				<div class="am-u-sm-12 img_div" v-if="selectList.user">
					<img
						src="http://static.iishang.com/customer/images/icons/user_select.png"
						width="20" height="20" />
				</div>
				<div class="am-u-sm-12" style="font-size: 12px; color:#666"
					v-if="!selectList.user">我的</div>
				<div class="am-u-sm-12" style="font-size: 12px; color: #fe5478"
					v-if="selectList.user">我的</div>
			</div>
		</div>

		<script type="text/javascript"
			src="https://dl.ntalker.com/js/xn6/ntkfstat.js?siteid=kf_9412"
			charset="utf-8"></script>



	</div>
</body>

<script type="text/javascript">
	var isWx = "";
	window.name = null;
	var app = new Vue(
			{
				el : '#app',
				data : {
					list : [
							{
								"image" : "http://static.iishang.com/customer/images/icons/address.png",
								"title" : "收货地址",
								"url" : "/address/myAddress.do"
							},
							{
								"image" : "http://static.iishang.com/customer/images/icons/card.png",
								"title" : "贺卡查询",
								"url" : "/card.do"
							},
							{
								"image" : "http://static.iishang.com/customer/images/icons/payRecord.png",
								"title" : "消费记录",
								"url" : "/record/toRecord.do"
							},
							{
								"image" : "http://static.iishang.com/customer/images/icons/aboutUs.png",
								"title" : "关于我们",
								"url" : "/userCenter/about_us.do"
							} ],
					user_avatar : 'http://flower2.oss-cn-hangzhou.aliyuncs.com/customer/images/v2/icons/default_avatar.png',
					user_obj : {},
					user_grade : '',
					userName : '',
					user_show_id : '',
					experience : '',
					integral : '',
					allOrders : '',
					waitOrders : '',
					serviceOrders : '',
					completeOrders : '',
					toBeGroup : '',
					toBeDelivery : '',
					selectList : {
						'home' : false,
						'service' : false,
						'cart' : false,
						'user' : true
					},
					couponsCount : 0,
					countInvod : 0,
					invitee : 0,
					redeemCount : 0,
					upgradeCount : 0,
					tip : {
						title : '提示',
						content : '',
						show : false,
						items : [],
						comfirm : false
					},
					isWx : isWx
				},
				computed : {

				},
				methods : {
					selectChange : function(x) {
						if (x == 'home') {
							this.selectList.home = true;
							this.selectList.service = false;
							this.selectList.cart = false;
							this.selectList.user = false;
						} else if (x == 'service') {
							this.selectList.home = false;
							this.selectList.service = true;
							this.selectList.cart = false;
							this.selectList.user = false;
						} else if (x == 'cart') {
							this.selectList.home = false;
							this.selectList.service = false;
							this.selectList.cart = true;
							this.selectList.user = false;
						} else {
							this.selectList.home = false;
							this.selectList.service = false;
							this.selectList.cart = false;
							this.selectList.user = true;
						}
						changePage(x);
					},

					logout : function() {
						showTip("提示", "确认退出吗？", [], true);
						//                logOut();
					},
					tipComfirmClick : function() {
						logOut();
					}

				},
				mounted : function() {
					initUserData(this);
					initUserOrderCount(this);
					getInvitation(this);
					loadMyCoupons(this);
					getInvitee(this);
					getUnUsedRedeemCount(this)
				},
				filters : {
					formatCount : function(d) {
						return d > parseInt(99999) ? "99999+" : d;
					}
				}

			});

	function changePage(page) {
		if (page == 'home') {
			window.location = '/Yun/index.html';
		} else {
			window.location = '/Yun/center.html';
		}
	}
	function initUserData(obj) {
		$.ajax({
			url : "userInfo",
			type : "POST",
			data : {},
			async : false,
			success : function(data) {
				var t = JSON.parse(data);
				console.log("data", data);
				obj.userName = t.showAlias;
				obj.user_show_id = t.showId;
				obj.user_avatar = t.wxIcon;

			}
		});

	}

	function getInvitation(obj) {
		$.ajax({
			url : api_addr + "/v2/user/invitation/count",
			type : "GET",
			data : {},
			async : false,
			success : function(result) {
				if (result != null && result.status == 'SUCCESS') {
					console.log("count", result);
					obj.countInvod = result.body;
				}
			}
		});
	}

	function logOut() {
		$.ajax({
			url : api_addr + "/auth/logout",
			type : "GET",
			data : {},
			async : false,
			success : function(result) {
				if (result != null && result.status == 'SUCCESS') {
					console.log("count", result);
					if (result.status == "SUCCESS") {
						window.location = '/home/youwx_toHome.do';
					}
				}
			}
		});
	}

	function showTip(title, content, items, comfirm) {
		app.tip.title = title;
		app.tip.content = content;
		app.tip.items = items;
		app.tip.show = true;
		app.tip.comfirm = comfirm;
	}

	function initUserOrderCount(obj) {
		$.ajax({
			url : api_addr + "/order/v2/orderAmount",
			type : "GET",
			data : {},
			async : false,
			success : function(data) {
				console.log("order", data);
				if (data != null && data.status == 'SUCCESS') {
					console.log("amount", data);
					obj.waitOrders = data.body.unPaidOrderAmount;
					obj.serviceOrders = data.body.inServiceOrderAmount;
					obj.toBeGroup = data.body.waitForGroupOrderAmount;
					obj.toBeDelivery = data.body.waitForDeliverOrderAmount;
					obj.upgradeCount = data.body.upgradeCount;
				}
			}
		});
	}

	function loadMyCoupons(obj) {
		$.ajax({
			url : api_addr + "v2/coupon/usable/count",
			success : function(data) {
				if (data.status == "SUCCESS") {
					console.log("coupons", data);
					obj.couponsCount = data.body;
				}
			}
		})
	}

	function getInvitee(obj) {
		$.ajax({
			url : api_addr + "user/invitation/invitee",
			type : "GET",
			data : {},
			async : false,
			success : function(result) {
				console.log("invitee", result);
				if (result != null && result.status == 'SUCCESS') {
					obj.invitee = result.body.length
				}
			}
		});
	}

	function getUnUsedRedeemCount(obj) {
		$.ajax({
			url : api_addr + "redeem/1",
			type : "GET",
			data : {},
			async : false,
			success : function(result) {
				console.log("invitee", result);
				if (result != null && result.status == 'SUCCESS') {
					obj.redeemCount = result.body.length
				}
			}
		});
	}
</script>
</html>
